"use strict";(self.webpackChunklunox=self.webpackChunklunox||[]).push([[1881],{9613:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>y});var i=t(9496);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),p=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=p(e.components);return i.createElement(s.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(t),m=a,y=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return t?i.createElement(y,o(o({ref:n},l),{},{components:t})):i.createElement(y,o({ref:n},l))}));function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=m;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[d]="string"==typeof e?e:a,o[1]=c;for(var p=2;p<r;p++)o[p]=t[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}m.displayName="MDXCreateElement"},650:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>p});var i=t(1163),a=(t(9496),t(9613));const r={sidebar_position:2},o="Service Container",c={unversionedId:"architecture-concepts/service-container",id:"version-1.x/architecture-concepts/service-container",title:"Service Container",description:"Lunox Service Container is inspired by Laravel's service container. The basic concept is same, but we have limitations because of nodejs nature. In Laravel, we can dynamically performing dependency injection. In Lunox, we must explicitly bind and resolve some class or instance.",source:"@site/versioned_docs/version-1.x/architecture-concepts/service-container.md",sourceDirName:"architecture-concepts",slug:"/architecture-concepts/service-container",permalink:"/id/docs/1.x/architecture-concepts/service-container",draft:!1,editUrl:"https://github.com/kodepandai/lunox-website/edit/main/versioned_docs/version-1.x/architecture-concepts/service-container.md",tags:[],version:"1.x",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Request Lifecycle",permalink:"/id/docs/1.x/architecture-concepts/request-lifecycle"},next:{title:"Service Provider",permalink:"/id/docs/1.x/architecture-concepts/service-provider"}},s={},p=[{value:"Binding",id:"binding",level:2},{value:"Simple Binding",id:"simple-binding",level:3},{value:"Singleton Binding",id:"singleton-binding",level:3},{value:"Resolving",id:"resolving",level:2},{value:"Make Typescript Happy",id:"make-typescript-happy",level:2}],l={toc:p},d="wrapper";function u(e){let{components:n,...r}=e;return(0,a.kt)(d,(0,i.Z)({},l,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"service-container"},"Service Container"),(0,a.kt)("p",null,"Lunox Service Container is inspired by Laravel's service container. The basic concept is same, but we have limitations because of nodejs nature. In Laravel, we can dynamically performing dependency injection. In Lunox, we must explicitly bind and resolve some class or instance."),(0,a.kt)("h2",{id:"binding"},"Binding"),(0,a.kt)("p",null,"We can bind some class or function to container instance and resolve it later somewhere in your application code."),(0,a.kt)("h3",{id:"simple-binding"},"Simple Binding"),(0,a.kt)("p",null,"Almost all of your service container bindings will be registered on service providers. Use ",(0,a.kt)("inlineCode",{parentName:"p"},"bind")," method to bind some class to container. In Laravel, we can bind class name to container, but there is nothing todo with nodejs. So we must use unique string to binding instance or function."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import Payment from './Service/Payment';\nimport db from './Support/DatabaseManager';\n\n// bind some class\nthis.app.bind('Payment', Payment);\n\n// bind function or instance\nthis.app.bind('Payment', ()=>new Payment('Paypall'));\n\n// or you can bind simple object to application instance\nthis.app.instance('db', db);\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"this.app")," is Lunox Application instance. See ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/kodepandai/lunox-framework/blob/main/src/Foundation/Application.ts"},"Application")," class for more detail."),(0,a.kt)("p",null,"Sometimes you cannot get application instance, for example outside service providers. You can use global ",(0,a.kt)("inlineCode",{parentName:"p"},"app()")," helper to get Lunox Application instance."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"app().bind('Payment', Payment);\n")),(0,a.kt)("h3",{id:"singleton-binding"},"Singleton Binding"),(0,a.kt)("p",null,"If you want bind some instance then share the instance object, use singleton instead. Once a singleton binding is resolved, the same object instance will be returned. I think you are familiar with this concept on Laravel."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import Counter from './Calc/Counter';\n\nthis.app.singleton('counter', Counter);\n")),(0,a.kt)("h2",{id:"resolving"},"Resolving"),(0,a.kt)("p",null,"To resolve some object from container, currently we only suppport ",(0,a.kt)("inlineCode",{parentName:"p"},"make")," method from application instance. We also can resolve by inserting ",(0,a.kt)("inlineCode",{parentName:"p"},"string")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"app()")," global method. Both example are same"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"const payment = this.app.make('Payment');\n\nconst payment = app('Payment');\n")),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"We can also resolve instance with property"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const payment = this.app.make("counter", {initialValue: 0})\n'))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Note that ",(0,a.kt)("inlineCode",{parentName:"p"},"app")," instance are singleton")),(0,a.kt)("h2",{id:"make-typescript-happy"},"Make Typescript Happy"),(0,a.kt)("p",null,"When we resolve some instance, typescript didn't know what instance actually is. We can add type hinting to the actual class or interface that resolved. See this example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import type Route from 'lunox/dist/Routing/Route';\n\nconst route = app<Route>(\"route\")\n")),(0,a.kt)("p",null,"now the IDE can detect all instance methods and properties \ud83d\ude04\n",(0,a.kt)("img",{alt:"typescript is happy",src:t(9940).Z,title:"Typescript is happy now",width:"570",height:"204"})))}u.isMDXComponent=!0},9940:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/resolving-d195deaa7caa827de0aa4f1c9cd7995a.png"}}]);