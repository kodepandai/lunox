"use strict";(self.webpackChunklunox=self.webpackChunklunox||[]).push([[5127],{9613:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var r=t(9496);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=r.createContext({}),l=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=l(e.components);return r.createElement(p.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(t),m=o,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return t?r.createElement(g,a(a({ref:n},c),{},{components:t})):r.createElement(g,a({ref:n},c))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=m;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s[d]="string"==typeof e?e:o,a[1]=s;for(var l=2;l<i;l++)a[l]=t[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},639:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=t(1163),o=(t(9496),t(9613));const i={sidebar_position:9},a="Error Handling",s={unversionedId:"basics/errors",id:"version-1.x/basics/errors",title:"Error Handling",description:"Introduction",source:"@site/versioned_docs/version-1.x/basics/errors.md",sourceDirName:"basics",slug:"/basics/errors",permalink:"/docs/1.x/basics/errors",draft:!1,editUrl:"https://github.com/kodepandai/lunox-website/edit/main/versioned_docs/version-1.x/basics/errors.md",tags:[],version:"1.x",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Validation",permalink:"/docs/1.x/basics/validation"},next:{title:"Artisan Console",permalink:"/docs/1.x/digging-deeper/artisan-console"}},p={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Configuration",id:"configuration",level:2},{value:"The Exception Handler",id:"the-exception-handler",level:2},{value:"Reporting Exception",id:"reporting-exception",level:3},{value:"Ignoring Exceptions By Type",id:"ignoring-exceptions-by-type",level:3},{value:"Rendering Exception",id:"rendering-exception",level:3},{value:"Http Exceptions",id:"http-exceptions",level:3}],c={toc:l},d="wrapper";function u(e){let{components:n,...t}=e;return(0,o.kt)(d,(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"error-handling"},"Error Handling"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"Error and Exception handling is already  configured by Lunox. The ",(0,o.kt)("inlineCode",{parentName:"p"},"app/Exceptions/Handler.ts")," file is where all exceptions thrown by your application and then reported and rendered to the user."),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"By default the ",(0,o.kt)("inlineCode",{parentName:"p"},"APP_DEBUG")," environment variable is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),", this is usefull for local development where you can see the error information more detail. In your production environment, this value should always be ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,o.kt)("h2",{id:"the-exception-handler"},"The Exception Handler"),(0,o.kt)("h3",{id:"reporting-exception"},"Reporting Exception"),(0,o.kt)("p",null,"All exceptions are handled by the ",(0,o.kt)("inlineCode",{parentName:"p"},"app/Exceptions/Handler")," class. This class contains a ",(0,o.kt)("inlineCode",{parentName:"p"},"register")," method where you may register custom exception reporting and rendering callbacks. Exception reporting is used to log exceptions. We may use the ",(0,o.kt)("inlineCode",{parentName:"p"},"reportable")," method to register a closure that should be executed when an exception of a given type needs to be reported."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import ApiException from "app/Exceptions/ApiException";\n\nregister(){\n    this.reportable(ApiException, (e) => {\n      if (e.status >= 500) {\n        console.log("API Error", e);\n      }\n    });\n}\n')),(0,o.kt)("h3",{id:"ignoring-exceptions-by-type"},"Ignoring Exceptions By Type"),(0,o.kt)("p",null,"When building your application, there will be some types of exceptions you simply want to ignore and never report. Your application's exception handler contains a ",(0,o.kt)("inlineCode",{parentName:"p"},"dontReport")," property which is initialized to an empty array. Any classes that you add to this property will never be reported; however, they may still have custom rendering logic:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import InvalidOrderException from 'app/Exceptions/InvalidOrderException';\n\nprotected dontReport = [\n    InvalidOrderException\n]\n")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},'Behind the scenes, Lunox already ignores some types of errors for you, such as exceptions resulting from 404 HTTP "not found" errors or 419 HTTP responses generated by invalid CSRF tokens.')),(0,o.kt)("h3",{id:"rendering-exception"},"Rendering Exception"),(0,o.kt)("p",null,"You are free to register a custom rendering closure for exceptions of a given type. You may accomplish this via the ",(0,o.kt)("inlineCode",{parentName:"p"},"renderable")," method of your exception handler. This closure should return instance of ",(0,o.kt)("inlineCode",{parentName:"p"},"Http Response")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"view Factory"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import {ValidationException, HttpException} from 'lunox';\n\nregister(){\n    this.renderable(ValidationException, (e, req) => {\n      if (req.wantsJson()) {\n        return Response.make(\n          {\n            message: e.message,\n            errors: e.errors(),\n            status: 422,\n          },\n          422\n        );\n      }\n\n      return back().withInput().with({\n        errors: e.errors(),\n      });\n    });\n\n    this.renderable(HttpException, (e, req) => {\n      if (req.wantsJson()) {\n        return Response.make(\n          {\n            message: e.message,\n            status: e.getStatusCode(),\n          },\n          e.getStatusCode()\n        );\n      }\n      return view(\"_error\", { message: e.message, code: e.getStatusCode() });\n    });\n}\n")),(0,o.kt)("h3",{id:"http-exceptions"},"Http Exceptions"),(0,o.kt)("p",null,'Some exceptions describe HTTP error codes from the server. For example, this may be a "page not found" error (404), an "unauthorized error" (401) or even a developer generated 500 error. In order to generate such a response from anywhere in your application, you may use the ',(0,o.kt)("inlineCode",{parentName:"p"},"abort")," helper:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"abort(404);\n")))}u.isMDXComponent=!0}}]);