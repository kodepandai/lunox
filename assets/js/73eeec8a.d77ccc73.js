"use strict";(self.webpackChunklunox=self.webpackChunklunox||[]).push([[9294],{9613:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>h});var a=t(9496);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(t),m=i,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return t?a.createElement(h,o(o({ref:n},l),{},{components:t})):a.createElement(h,o({ref:n},l))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=m;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[d]="string"==typeof e?e:i,o[1]=c;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7075:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>p});var a=t(1163),i=(t(9496),t(9613));const r={sidebar_position:2},o="Service Container",c={unversionedId:"architecture-concepts/service-container",id:"architecture-concepts/service-container",title:"Service Container",description:"The Lunox Service Container is inspired by Laravel's service container. The basic concept is the same, but we have some limitations due to the nature of Node.js. In Laravel, we can dynamically perform dependency injection, whereas in Lunox, we must explicitly bind and resolve classes or instances.",source:"@site/docs/architecture-concepts/service-container.md",sourceDirName:"architecture-concepts",slug:"/architecture-concepts/service-container",permalink:"/docs/architecture-concepts/service-container",draft:!1,editUrl:"https://github.com/kodepandai/lunox-website/edit/main/docs/architecture-concepts/service-container.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Request Lifecycle",permalink:"/docs/architecture-concepts/request-lifecycle"},next:{title:"Service Provider",permalink:"/docs/architecture-concepts/service-provider"}},s={},p=[{value:"Binding",id:"binding",level:2},{value:"Simple Binding",id:"simple-binding",level:3},{value:"Singleton Binding",id:"singleton-binding",level:3},{value:"Resolving",id:"resolving",level:2},{value:"Making TypeScript Happy",id:"making-typescript-happy",level:2}],l={toc:p},d="wrapper";function u(e){let{components:n,...r}=e;return(0,i.kt)(d,(0,a.Z)({},l,r,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"service-container"},"Service Container"),(0,i.kt)("p",null,"The Lunox Service Container is inspired by Laravel's service container. The basic concept is the same, but we have some limitations due to the nature of Node.js. In Laravel, we can dynamically perform dependency injection, whereas in Lunox, we must explicitly bind and resolve classes or instances."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"We are planning to implement dependency injection in the future using decorators and metadata. This approach will allow for a more elegant and intuitive way of managing dependencies in Lunox.")),(0,i.kt)("h2",{id:"binding"},"Binding"),(0,i.kt)("p",null,"We can bind classes or functions to the container instance and resolve them later in different parts of our application code."),(0,i.kt)("h3",{id:"simple-binding"},"Simple Binding"),(0,i.kt)("p",null,"Most of your service container bindings will be registered in service providers. Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"bind")," method to bind a class to the container. In Laravel, we can bind a class name to the container, but in Node.js, we need to use a unique ",(0,i.kt)("inlineCode",{parentName:"p"},"string")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"Symbol")," as the binding identifier."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import Payment from "./Service/Payment";\nimport db from "./Support/DatabaseManager";\n\n// Bind a class\nthis.app.bind("Payment", Payment);\n\n// Bind a function or instance\nthis.app.bind("Payment", () => new Payment("Paypall"));\n\n// Bind a simple object to the application instance\nthis.app.instance(Symbol("DatabaseManager"), db);\n')),(0,i.kt)("p",null,"In the above code, ",(0,i.kt)("inlineCode",{parentName:"p"},"this.app")," refers to the Lunox Application instance. Please refer to the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/kodepandai/lunox/blob/next/packages/lunox-core/src/Foundation/Application.ts"},"Application")," class for more details."),(0,i.kt)("p",null,"Sometimes, you may need to access the application instance outside of service providers. In such cases, you can use the global ",(0,i.kt)("inlineCode",{parentName:"p"},"app()")," helper function to get the Lunox Application instance."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'app().bind("Payment", Payment);\n')),(0,i.kt)("h3",{id:"singleton-binding"},"Singleton Binding"),(0,i.kt)("p",null,"If you want to bind an instance and share the same object instance, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"singleton")," method. Once a singleton binding is resolved, the same object instance will be returned. This concept should be familiar to you if you have used Laravel."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import Counter from "./Calc/Counter";\n\nthis.app.singleton("counter", Counter);\n')),(0,i.kt)("h2",{id:"resolving"},"Resolving"),(0,i.kt)("p",null,"To resolve an object from the container, we currently only support the ",(0,i.kt)("inlineCode",{parentName:"p"},"make")," method from the application instance. Alternatively, you can also resolve an object by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"string")," parameter with the ",(0,i.kt)("inlineCode",{parentName:"p"},"app()")," global method. Both examples are equivalent."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const payment = this.app.make("Payment");\n\nconst payment = app("Payment");\n')),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"We can also resolve an instance with properties."),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const payment = this.app.make("counter", { initialValue: 0 });\n'))),(0,i.kt)("p",null,"Please note that the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," instance is a singleton."),(0,i.kt)("h2",{id:"making-typescript-happy"},"Making TypeScript Happy"),(0,i.kt)("p",null,"When we resolve an instance, TypeScript doesn't know the actual type of the instance. To address this, we can add type hinting to the actual class or interface that is being resolved. Here's an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import type { Router } from "@lunoxjs/core";\n\nconst route = app<Router>("route");\n')),(0,i.kt)("p",null,"By providing the type hint, the IDE can detect all the instance methods and properties, making TypeScript happy."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"TypeScript is happy",src:t(4052).Z,title:"TypeScript is happy now",width:"570",height:"204"})),(0,i.kt)("p",null,"Please note that I made some adjustments for clarity and improved readability. If you have any further questions or need additional assistance, feel free to ask!"))}u.isMDXComponent=!0},4052:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/resolving-d195deaa7caa827de0aa4f1c9cd7995a.png"}}]);